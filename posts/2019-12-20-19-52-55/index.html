<!doctype html><html lang=en dir=auto>
<head><meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=robots content="index, follow">
<title>Не просто корреляция | rprtr258</title>
<meta name=keywords content="middleread">
<meta name=description content="&ldquo;url&rdquo;: &ldquo;https://sun9-61.userapi.com/impg/c854420/v854420865/1a5533/DsEOHTmQEsQ.jpg?size=1280x882&quality=96&sign=3d225d5410fe9b900d474c1feaabc2f0&c_uniq_tag=VLyQ6XpeIQwhRYowYtn3T31gicI6qA-13r2qPi5TxkI&type=album&#34;,
Корреляция в статистике это способ измерить, насколько связаны два фактора. Например корреляция Пирсона — это число от -1 до 1, которое означает тесную степень связости при приближении этого числа к -1 или 1, но слабую, если корреляция близка к 0. Знак этой корреляции говорит, связаны ли величины положительно или отрицательно, то есть при увеличении одного фактора будет другой фактор увеличиваться или же уменьшаться.
Однако проблема с корреляцией Пирсона в том, что она считается для двух количественных переменных, или как говорят дата саентисты(я) численных фич.">
<meta name=author content>
<link rel=canonical href=https://rprtr258.github.io/posts/2019-12-20-19-52-55/>
<link crossorigin=anonymous href=/assets/css/stylesheet.bc1149f4a72aa4858d3a9f71462f75e5884ffe8073ea9d6d5761d5663d651e20.css integrity="sha256-vBFJ9KcqpIWNOp9xRi915YhP/oBz6p1tV2HVZj1lHiA=" rel="preload stylesheet" as=style>
<script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://rprtr258.github.io/favicon.ico>
<link rel=icon type=image/png sizes=16x16 href=https://rprtr258.github.io/favicon-16x16.png>
<link rel=icon type=image/png sizes=32x32 href=https://rprtr258.github.io/favicon-32x32.png>
<link rel=apple-touch-icon href=https://rprtr258.github.io/apple-touch-icon.png>
<link rel=mask-icon href=https://rprtr258.github.io/safari-pinned-tab.svg>
<meta name=theme-color content="#2e2e33">
<meta name=msapplication-TileColor content="#2e2e33">
<noscript>
<style>#theme-toggle,.top-link{display:none}</style>
<style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style>
</noscript><style>.main{max-width:calc(var(--main-width) + var(--gap) * 14)!important}article.first-entry{justify-content:inherit;min-height:auto}</style>
<script type=text/x-mathjax-config>
MathJax.Hub.Config({
  messageStyle: "none",
  tex2jax: {
    inlineMath: [["\\(", "\\)"]],
    displayMath: [["\\[", "\\]"]],
    ignoreClass: "nostem|nolatexmath"
  },
  asciimath2jax: {
    delimiters: [["\\$", "\\$"]],
    ignoreClass: "nostem|noasciimath"
  },
  TeX: { equationNumbers: { autoNumber: "none" } }
});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script>
<meta property="og:title" content="Не просто корреляция">
<meta property="og:description" content="&ldquo;url&rdquo;: &ldquo;https://sun9-61.userapi.com/impg/c854420/v854420865/1a5533/DsEOHTmQEsQ.jpg?size=1280x882&quality=96&sign=3d225d5410fe9b900d474c1feaabc2f0&c_uniq_tag=VLyQ6XpeIQwhRYowYtn3T31gicI6qA-13r2qPi5TxkI&type=album&#34;,
Корреляция в статистике это способ измерить, насколько связаны два фактора. Например корреляция Пирсона — это число от -1 до 1, которое означает тесную степень связости при приближении этого числа к -1 или 1, но слабую, если корреляция близка к 0. Знак этой корреляции говорит, связаны ли величины положительно или отрицательно, то есть при увеличении одного фактора будет другой фактор увеличиваться или же уменьшаться.
Однако проблема с корреляцией Пирсона в том, что она считается для двух количественных переменных, или как говорят дата саентисты(я) численных фич.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://rprtr258.github.io/posts/2019-12-20-19-52-55/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2019-12-20T19:52:55+00:00">
<meta property="article:modified_time" content="2019-12-20T19:52:55+00:00">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="Не просто корреляция">
<meta name=twitter:description content="&ldquo;url&rdquo;: &ldquo;https://sun9-61.userapi.com/impg/c854420/v854420865/1a5533/DsEOHTmQEsQ.jpg?size=1280x882&quality=96&sign=3d225d5410fe9b900d474c1feaabc2f0&c_uniq_tag=VLyQ6XpeIQwhRYowYtn3T31gicI6qA-13r2qPi5TxkI&type=album&#34;,
Корреляция в статистике это способ измерить, насколько связаны два фактора. Например корреляция Пирсона — это число от -1 до 1, которое означает тесную степень связости при приближении этого числа к -1 или 1, но слабую, если корреляция близка к 0. Знак этой корреляции говорит, связаны ли величины положительно или отрицательно, то есть при увеличении одного фактора будет другой фактор увеличиваться или же уменьшаться.
Однако проблема с корреляцией Пирсона в том, что она считается для двух количественных переменных, или как говорят дата саентисты(я) численных фич.">
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://rprtr258.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Не просто корреляция","item":"https://rprtr258.github.io/posts/2019-12-20-19-52-55/"}]}</script>
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Не просто корреляция","name":"Не просто корреляция","description":"\u0026ldquo;url\u0026rdquo;: \u0026ldquo;https://sun9-61.userapi.com/impg/c854420/v854420865/1a5533/DsEOHTmQEsQ.jpg?size=1280x882\u0026amp;quality=96\u0026amp;sign=3d225d5410fe9b900d474c1feaabc2f0\u0026amp;c_uniq_tag=VLyQ6XpeIQwhRYowYtn3T31gicI6qA-13r2qPi5TxkI\u0026amp;type=album\u0026quot;,\nКорреляция в статистике это способ измерить, насколько связаны два фактора. Например корреляция Пирсона — это число от -1 до 1, которое означает тесную степень связости при приближении этого числа к -1 или 1, но слабую, если корреляция близка к 0. Знак этой корреляции говорит, связаны ли величины положительно или отрицательно, то есть при увеличении одного фактора будет другой фактор увеличиваться или же уменьшаться.\nОднако проблема с корреляцией Пирсона в том, что она считается для двух количественных переменных, или как говорят дата саентисты(я) численных фич.","keywords":["middleread"],"articleBody":"“url”: “https://sun9-61.userapi.com/impg/c854420/v854420865/1a5533/DsEOHTmQEsQ.jpg?size=1280x882\u0026quality=96\u0026sign=3d225d5410fe9b900d474c1feaabc2f0\u0026c_uniq_tag=VLyQ6XpeIQwhRYowYtn3T31gicI6qA-13r2qPi5TxkI\u0026type=album\",\nКорреляция в статистике это способ измерить, насколько связаны два фактора. Например корреляция Пирсона — это число от -1 до 1, которое означает тесную степень связости при приближении этого числа к -1 или 1, но слабую, если корреляция близка к 0. Знак этой корреляции говорит, связаны ли величины положительно или отрицательно, то есть при увеличении одного фактора будет другой фактор увеличиваться или же уменьшаться.\nОднако проблема с корреляцией Пирсона в том, что она считается для двух количественных переменных, или как говорят дата саентисты(я) численных фич. Тем не менее, нам может быть интересно узнать, есть ли зависимость между фичами и целевой переменной если фича категориальная.\nЕще раз про корреляцию Посмотрим внимательнее на формулу корреляции Пирсона:\nhttps://sun9-70.userapi.com/impg/c854420/v854420097/1a3204/z8IPoVOobVc.jpg?size=148x48\u0026quality=96\u0026sign=2b22f816f7e4588b8a25699c860a4be1\u0026type=album\nПо сути это нормализация ковариации, в том смысле, что ковариация делится на произведение (корней из) ковариаций внутри переменных, откуда из неравенства Коши-Буняковского корреляция по модулю меньше единицы. Получается мы меряем (линейную) связь между переменными с помощью ковариации и затем нормализуем ее. А именно, если cov(X, Y) — большое число, то связь между переменными сильная, так как E(XY) за вычетом E(X)E(Y) все еще большое число и значит в произведении есть еще часть от произведения X и Y, которая остается в ковариации. Если же переменные почти независимы, то cov(X, Y) становится приблизительно равной E(X-EX)E(Y-EY)=(EX-EX)(EY-EY)=0, и коэффициент корреляции близок к 0.\nСлучай 1. Связь между категориальной и численной фичами Тут имеет смысл попробовать также посмотреть величину отклонений(дисперсий) относительно среднего всей выборки и нормализовать, чтобы учесть величины дисперсий в каждом классе. Формально это можно записать так:\nhttps://sun9-4.userapi.com/impg/c854420/v854420216/1b172d/4YI2pHy8WkY.jpg?size=522x82\u0026quality=96\u0026sign=f07f233b12d74ca4d5126a96a07c33cf\u0026type=album\nгде числитель — это взвешенная дисперсия средних в каждом классе относительно среднего всей выборки, а знаменатель — сумма дисперсий по каждому классу плюс числитель. Веса это просто количество обьектов каждого класса.\nРассмотрим пример, есть оценки учеников по Анализу Данных по каждому полу(я хотел взять оценки по ЕГЭ, но этих данных не существует):\nhttps://sun9-61.userapi.com/impg/c854420/v854420097/1a3337/Afhp6Lm7ilQ.jpg?size=211x410\u0026quality=96\u0026sign=9f92c4501498a0100a2e90757ed9b757\u0026type=album\nВсего в выборке 7 девушек и 18 мужчин. Посчитаем средние значения по каждому классу и для всей выборки:\nhttps://sun9-48.userapi.com/impg/c854420/v854420097/1a335a/E5vVA_yMEDs.jpg?size=485x79\u0026quality=96\u0026sign=663aae8d5671de5008183763d10f99c6\u0026type=album\nПочему я вспомнил про условное матожидание лол\nПосчитаем дисперсии по каждому классу:\nhttps://sun9-84.userapi.com/impg/c854420/v854420216/1b1788/HfagoPOlUWU.jpg?size=193x41\u0026quality=96\u0026sign=1e91dcfefba8f9e22d944bdbddf8d9d1\u0026type=album\nОмайгад, где поправка Бесселя, ты что крейзи?\nСумма дисперсий по каждому классу называется внутригрупповой дисперсией.\nНайдем межгрупповую дисперсию:\nhttps://sun9-75.userapi.com/impg/c854420/v854420216/1b1792/5ptGFiHweEE.jpg?size=588x65\u0026quality=96\u0026sign=9629dda8ff45fd957045c5e036f41b22\u0026type=album\nИ наконец значение коэффициента корреляции, который, кстати, называется отношением корреляции:\nhttps://sun9-67.userapi.com/impg/c854420/v854420216/1b17ad/BjyojGzbvwc.jpg?size=310x42\u0026quality=96\u0026sign=c8dfff04c3988c832bbeb1502f356268\u0026type=album\nТо есть связи слабая. Скорее всего у какого-то пола есть перекос в определенную сторону для оценки. Судя по приведенным выше данным(матожиданиям и дисперсиям) девушки склонны получать оценки меньше. Все еще можно проверить эту гипотезу на большей выборке, так как критерий p-значимости как считать я не знаю, как и не знаю достаточно ли приведенных данных. Плюс эти данные взяты из оценок по предмету в конце семестра, откуда и появилось много оценок 100, но возможно перекос в оценках также вызван этим.\nСамо по себе отношение корреляции всегда находится в пределах от 0 до 1, что очевидно из определения, и ее значения можно расценивать по следующей таблице:\nhttps://sun9-73.userapi.com/impg/c854420/v854420216/1b1708/nsaWzpMFCYQ.jpg?size=795x286\u0026quality=96\u0026sign=54dcfc473fe392dbd6cb2746e8f84055\u0026type=album\nСлучай 2. Связь между категориальной и категориальной фичами Теперь у нас нет даже единственной численной фичи, а есть только категории. Но мы все еще хотим узнать насколько они связаны, то есть насколько принадлежность разным классам влияет на различие принадлежности к другим классам.\nСразу приведем формулу\nhttps://sun9-14.userapi.com/impg/c854420/v854420865/1a53c5/7IIfQU9bcQE.jpg?size=481x75\u0026quality=96\u0026sign=d7d888a16e225cc021c8b9b86e5a83e3\u0026type=album\nЭтот коэффициент также находится в пределах от 0 до 1 и называется коэффициентом Крамера. Разберемся что здесь к чему:\nn — количество всех обьектов в выборке\nкол-во строк/столбцов — количество различных классов первой и второй фичи, из них берется минимум и вычитается 1\nχ — критерий согласия хи-квадрат(также критерий согласия Пирсона). Кто не знает, хи-квадрат с k степенью свобод это распределение суммы квадратов k независимых нормально распределенных величин. Предполагая, что все величины в мире распределены нормально, мы можем захотеть изучить распределение их квадратов, например, чтобы не зависеть от их знака. Критерий хи-квадрат применяют, когда хотят проверить распределение случайно переменной относительно конечного числа промежутков.\nОпишем, как посчитать этот критерий.\nДля начала, количество обьектов каждой пары классов в нашей выборке, называется эмпирической частотой, потому что оно приближает реально распределение и получено с помощью эксперимента. Помимо этого, нам нужно найти количества обьектов каждой пары классов при условии независимости этих классов. Это количество называется теоретической частотой: какое в теории должно быть количество обьектов, чтобы связи не было.\nТеоретическая частота для каждой пары классов считается как вероятность получить первым классом класс A, а вторым — класс X, если эти классы независимы(нулевая гипотеза H_0) умножить на количество всех обьектов. Для каждой пары классов A первой категориальной фичи и X второй категориальной фичи теоретическая частота считается по следующей формуле:\nhttps://sun9-79.userapi.com/impg/c855236/v855236756/1a9b6b/slKyLerjoHM.jpg?size=650x39\u0026quality=96\u0026sign=2e9d3223f56e193c2f7335375c8d5c0a\u0026type=album\nГде N — количество всех обьектов.\nЗатем для каждой пары классов считается число, которое затем в сумме по всем парам классов даст критерий хи-квадрат:\nhttps://sun9-46.userapi.com/impg/c854420/v854420865/1a5460/tLEFgV96Yiw.jpg?size=557x67\u0026quality=96\u0026sign=462fd032d2b71c99bdee566de27f8297\u0026type=album\nВ итоге формула для критерия хи-квадрат следующая:\nhttps://sun9-1.userapi.com/impg/c855236/v855236925/1ab192/QqmSQutjX_s.jpg?size=483x91\u0026quality=96\u0026sign=873d6948483484da165287a25a38a809\u0026type=album\nНа всякий: n(…) это количество обьектов определенного класса(или классов) из нашей выборки, tf — теоретическая частота\nЗатем это значение подставляется в исходную формулу, где остальные переменные известны.\nПриведем пример(из манги да): провели опрос среди читателей журнала с просьбой указать желаемый вид признания в любви из трех и свой пол. Получили следующие данные:\nhttps://sun9-87.userapi.com/impg/c854420/v854420865/1a547b/YJUFPC0mLGY.jpg?size=807x231\u0026quality=96\u0026sign=464d1ee30584bd2a86ae206a0cc0a196\u0026type=album\nВыражения для теоретических частот для каждой пары классов. В каждом столбце внизу написано количество обьектов по способу признания, а справа для каждой строки количество обьектов для каждого пола. Формула для теоретической частоты в нашем случае: n(способ) * n(пол) / N, для каждой пары (способ, пол):\nhttps://sun9-81.userapi.com/impg/c854420/v854420865/1a5484/lx1ADZfccP8.jpg?size=807x312\u0026quality=96\u0026sign=0fc2572e7e8cb20bb98fc86b83f06b2f\u0026type=album\nНаходим коэффициент хи-квадрат:\nhttps://sun9-65.userapi.com/impg/c854420/v854420865/1a548d/ZlCHKeq-k6A.jpg?size=807x410\u0026quality=96\u0026sign=07eb2db149ee0761f3335798d691aec8\u0026type=album\nПодставим это значение в формулу для коэффициента Крамера:\nhttps://sun9-73.userapi.com/impg/c854420/v854420865/1a5495/bNX8UHcPQkY.jpg?size=792x125\u0026quality=96\u0026sign=f2a4ae8d97d49eeeadb64cd360495dff\u0026type=album\nПолучили значение, которое говорит об отстутствии связи. Другими словами не получится хорошо предсказывать желаемый способ признания для человека, зная только его пол. И наоборот, зная, какой способ признания нравится человеку(с которым вы например переписываетесь в интернете) определить его пол.\nТаблица, для интерпретации тесноты связи та же, что и для отношения корреляции. Здесь коэффициент меньше 0,25 так что связь слабая. Вывод\nТаким образом, если у вас есть категориальные значения, и вы хотите посчитать их связь с целевой переменной или классом, то не все так плохо! Соответствующие коэффициенты считаются за линейное время и позволяют также, как и корреляция Пирсона, говорить о связи переменных.\nМне же теперь придется использовать эти коэффициенты для оценок полезности в соревновании про дома и, возможно, других исследованиях.\n","wordCount":"992","inLanguage":"en","datePublished":"2019-12-20T19:52:55Z","dateModified":"2019-12-20T19:52:55Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://rprtr258.github.io/posts/2019-12-20-19-52-55/"},"publisher":{"@type":"Organization","name":"rprtr258","logo":{"@type":"ImageObject","url":"https://rprtr258.github.io/favicon.ico"}}}</script>
</head>
<body id=top>
<script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script>
<header class=header>
<nav class=nav>
<div class=logo>
<a href=https://rprtr258.github.io/ accesskey=h title="rprtr258 (Alt + H)">rprtr258</a>
<div class=logo-switches>
<button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</button>
</div>
</div>
<ul id=menu>
<li>
<a href=https://rprtr258.github.io/watch_list/ title="Watch list">
<span>Watch list</span>
</a>
</li>
<li>
<a href=https://rprtr258.github.io/cv/ title=CV>
<span>CV</span>
</a>
</li>
<li>
<a href=https://rprtr258.github.io/menhera/ title="Menhera chan">
<span>Menhera chan</span>
</a>
</li>
<li>
<a href=https://rprtr258.github.io/mmheroes/ title=MMHeroes>
<span>MMHeroes</span>
</a>
</li>
<li>
<a href=https://rprtr258.github.io/utils/ title="Utils (18+)">
<span>Utils (18+)</span>
</a>
</li>
<li>
<a href=https://rprtr258.github.io/memes/ title=Memes>
<span>Memes</span>
</a>
</li>
</ul>
</nav>
</header>
<main class=main>
<article class=post-single>
<header class=post-header>
<div class=breadcrumbs><a href=https://rprtr258.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://rprtr258.github.io/posts/>Posts</a></div>
<h1 class=post-title>
Не просто корреляция
</h1>
<div class=post-meta><span title="2019-12-20 19:52:55 +0000 UTC">December 20, 2019</span>
</div>
</header>
<div class=post-content><p>&ldquo;url&rdquo;: &ldquo;<a href="https://sun9-61.userapi.com/impg/c854420/v854420865/1a5533/DsEOHTmQEsQ.jpg?size=1280x882&quality=96&sign=3d225d5410fe9b900d474c1feaabc2f0&c_uniq_tag=VLyQ6XpeIQwhRYowYtn3T31gicI6qA-13r2qPi5TxkI&type=album%22">https://sun9-61.userapi.com/impg/c854420/v854420865/1a5533/DsEOHTmQEsQ.jpg?size=1280x882&quality=96&sign=3d225d5410fe9b900d474c1feaabc2f0&c_uniq_tag=VLyQ6XpeIQwhRYowYtn3T31gicI6qA-13r2qPi5TxkI&type=album"</a>,</p>
<p>Корреляция в статистике это способ измерить, насколько связаны два фактора. Например корреляция Пирсона — это число от -1 до 1, которое означает тесную степень связости при приближении этого числа к -1 или 1, но слабую, если корреляция близка к 0. Знак этой корреляции говорит, связаны ли величины положительно или отрицательно, то есть при увеличении одного фактора будет другой фактор увеличиваться или же уменьшаться.</p>
<p>Однако проблема с корреляцией Пирсона в том, что она считается для двух количественных переменных, или как говорят дата саентисты(я) численных фич. Тем не менее, нам может быть интересно узнать, есть ли зависимость между фичами и целевой переменной если фича категориальная.</p>
<h2 id=еще-раз-про-корреляцию>Еще раз про корреляцию<a hidden class=anchor aria-hidden=true href=#еще-раз-про-корреляцию>#</a></h2>
<p>Посмотрим внимательнее на формулу корреляции Пирсона:</p>
<p><a href="https://sun9-70.userapi.com/impg/c854420/v854420097/1a3204/z8IPoVOobVc.jpg?size=148x48&quality=96&sign=2b22f816f7e4588b8a25699c860a4be1&type=album">https://sun9-70.userapi.com/impg/c854420/v854420097/1a3204/z8IPoVOobVc.jpg?size=148x48&quality=96&sign=2b22f816f7e4588b8a25699c860a4be1&type=album</a></p>
<p>По сути это нормализация ковариации, в том смысле, что ковариация делится на произведение (корней из) ковариаций внутри переменных, откуда из неравенства Коши-Буняковского корреляция по модулю меньше единицы. Получается мы меряем (линейную) связь между переменными с помощью ковариации и затем нормализуем ее. А именно, если cov(X, Y) — большое число, то связь между переменными сильная, так как E(XY) за вычетом E(X)E(Y) все еще большое число и значит в произведении есть еще часть от произведения X и Y, которая остается в ковариации. Если же переменные почти независимы, то cov(X, Y) становится приблизительно равной E(X-EX)E(Y-EY)=(EX-EX)(EY-EY)=0, и коэффициент корреляции близок к 0.</p>
<h2 id=случай-1-связь-между-категориальной-и-численной-фичами>Случай 1. Связь между категориальной и численной фичами<a hidden class=anchor aria-hidden=true href=#случай-1-связь-между-категориальной-и-численной-фичами>#</a></h2>
<p>Тут имеет смысл попробовать также посмотреть величину отклонений(дисперсий) относительно среднего всей выборки и нормализовать, чтобы учесть величины дисперсий в каждом классе. Формально это можно записать так:</p>
<p><a href="https://sun9-4.userapi.com/impg/c854420/v854420216/1b172d/4YI2pHy8WkY.jpg?size=522x82&quality=96&sign=f07f233b12d74ca4d5126a96a07c33cf&type=album">https://sun9-4.userapi.com/impg/c854420/v854420216/1b172d/4YI2pHy8WkY.jpg?size=522x82&quality=96&sign=f07f233b12d74ca4d5126a96a07c33cf&type=album</a></p>
<p>где числитель — это взвешенная дисперсия средних в каждом классе относительно среднего всей выборки, а знаменатель — сумма дисперсий по каждому классу плюс числитель. Веса это просто количество обьектов каждого класса.</p>
<p>Рассмотрим пример, есть оценки учеников по Анализу Данных по каждому полу(я хотел взять оценки по ЕГЭ, но этих данных не существует):</p>
<p><a href="https://sun9-61.userapi.com/impg/c854420/v854420097/1a3337/Afhp6Lm7ilQ.jpg?size=211x410&quality=96&sign=9f92c4501498a0100a2e90757ed9b757&type=album">https://sun9-61.userapi.com/impg/c854420/v854420097/1a3337/Afhp6Lm7ilQ.jpg?size=211x410&quality=96&sign=9f92c4501498a0100a2e90757ed9b757&type=album</a></p>
<p>Всего в выборке 7 девушек и 18 мужчин. Посчитаем средние значения по каждому классу и для всей выборки:</p>
<p><a href="https://sun9-48.userapi.com/impg/c854420/v854420097/1a335a/E5vVA_yMEDs.jpg?size=485x79&quality=96&sign=663aae8d5671de5008183763d10f99c6&type=album">https://sun9-48.userapi.com/impg/c854420/v854420097/1a335a/E5vVA_yMEDs.jpg?size=485x79&quality=96&sign=663aae8d5671de5008183763d10f99c6&type=album</a></p>
<p>Почему я вспомнил про условное матожидание лол</p>
<p>Посчитаем дисперсии по каждому классу:</p>
<p><a href="https://sun9-84.userapi.com/impg/c854420/v854420216/1b1788/HfagoPOlUWU.jpg?size=193x41&quality=96&sign=1e91dcfefba8f9e22d944bdbddf8d9d1&type=album">https://sun9-84.userapi.com/impg/c854420/v854420216/1b1788/HfagoPOlUWU.jpg?size=193x41&quality=96&sign=1e91dcfefba8f9e22d944bdbddf8d9d1&type=album</a></p>
<p>Омайгад, где поправка Бесселя, ты что крейзи?</p>
<p>Сумма дисперсий по каждому классу называется внутригрупповой дисперсией.</p>
<p>Найдем межгрупповую дисперсию:</p>
<p><a href="https://sun9-75.userapi.com/impg/c854420/v854420216/1b1792/5ptGFiHweEE.jpg?size=588x65&quality=96&sign=9629dda8ff45fd957045c5e036f41b22&type=album">https://sun9-75.userapi.com/impg/c854420/v854420216/1b1792/5ptGFiHweEE.jpg?size=588x65&quality=96&sign=9629dda8ff45fd957045c5e036f41b22&type=album</a></p>
<p>И наконец значение коэффициента корреляции, который, кстати, называется отношением корреляции:</p>
<p><a href="https://sun9-67.userapi.com/impg/c854420/v854420216/1b17ad/BjyojGzbvwc.jpg?size=310x42&quality=96&sign=c8dfff04c3988c832bbeb1502f356268&type=album">https://sun9-67.userapi.com/impg/c854420/v854420216/1b17ad/BjyojGzbvwc.jpg?size=310x42&quality=96&sign=c8dfff04c3988c832bbeb1502f356268&type=album</a></p>
<p>То есть связи слабая. Скорее всего у какого-то пола есть перекос в определенную сторону для оценки. Судя по приведенным выше данным(матожиданиям и дисперсиям) девушки склонны получать оценки меньше. Все еще можно проверить эту гипотезу на большей выборке, так как критерий p-значимости как считать я не знаю, как и не знаю достаточно ли приведенных данных. Плюс эти данные взяты из оценок по предмету в конце семестра, откуда и появилось много оценок 100, но возможно перекос в оценках также вызван этим.</p>
<p>Само по себе отношение корреляции всегда находится в пределах от 0 до 1, что очевидно из определения, и ее значения можно расценивать по следующей таблице:</p>
<p><a href="https://sun9-73.userapi.com/impg/c854420/v854420216/1b1708/nsaWzpMFCYQ.jpg?size=795x286&quality=96&sign=54dcfc473fe392dbd6cb2746e8f84055&type=album">https://sun9-73.userapi.com/impg/c854420/v854420216/1b1708/nsaWzpMFCYQ.jpg?size=795x286&quality=96&sign=54dcfc473fe392dbd6cb2746e8f84055&type=album</a></p>
<h2 id=случай-2-связь-между-категориальной-и-категориальной-фичами>Случай 2. Связь между категориальной и категориальной фичами<a hidden class=anchor aria-hidden=true href=#случай-2-связь-между-категориальной-и-категориальной-фичами>#</a></h2>
<p>Теперь у нас нет даже единственной численной фичи, а есть только категории. Но мы все еще хотим узнать насколько они связаны, то есть насколько принадлежность разным классам влияет на различие принадлежности к другим классам.</p>
<p>Сразу приведем формулу</p>
<p><a href="https://sun9-14.userapi.com/impg/c854420/v854420865/1a53c5/7IIfQU9bcQE.jpg?size=481x75&quality=96&sign=d7d888a16e225cc021c8b9b86e5a83e3&type=album">https://sun9-14.userapi.com/impg/c854420/v854420865/1a53c5/7IIfQU9bcQE.jpg?size=481x75&quality=96&sign=d7d888a16e225cc021c8b9b86e5a83e3&type=album</a></p>
<p>Этот коэффициент также находится в пределах от 0 до 1 и называется коэффициентом Крамера. Разберемся что здесь к чему:</p>
<p>n — количество всех обьектов в выборке</p>
<p>кол-во строк/столбцов — количество различных классов первой и второй фичи, из них берется минимум и вычитается 1</p>
<p>χ — критерий согласия хи-квадрат(также критерий согласия Пирсона). Кто не знает, хи-квадрат с k степенью свобод это распределение суммы квадратов k независимых нормально распределенных величин. Предполагая, что все величины в мире распределены нормально, мы можем захотеть изучить распределение их квадратов, например, чтобы не зависеть от их знака. Критерий хи-квадрат применяют, когда хотят проверить распределение случайно переменной относительно конечного числа промежутков.</p>
<p>Опишем, как посчитать этот критерий.</p>
<p>Для начала, количество обьектов каждой пары классов в нашей выборке, называется эмпирической частотой, потому что оно приближает реально распределение и получено с помощью эксперимента.
Помимо этого, нам нужно найти количества обьектов каждой пары классов при условии независимости этих классов. Это количество называется теоретической частотой: какое в теории должно быть количество обьектов, чтобы связи не было.</p>
<p>Теоретическая частота для каждой пары классов считается как вероятность получить первым классом класс A, а вторым — класс X, если эти классы независимы(нулевая гипотеза H_0) умножить на количество всех обьектов. Для каждой пары классов A первой категориальной фичи и X второй категориальной фичи теоретическая частота считается по следующей формуле:</p>
<p><a href="https://sun9-79.userapi.com/impg/c855236/v855236756/1a9b6b/slKyLerjoHM.jpg?size=650x39&quality=96&sign=2e9d3223f56e193c2f7335375c8d5c0a&type=album">https://sun9-79.userapi.com/impg/c855236/v855236756/1a9b6b/slKyLerjoHM.jpg?size=650x39&quality=96&sign=2e9d3223f56e193c2f7335375c8d5c0a&type=album</a></p>
<p>Где N — количество всех обьектов.</p>
<p>Затем для каждой пары классов считается число, которое затем в сумме по всем парам классов даст критерий хи-квадрат:</p>
<p><a href="https://sun9-46.userapi.com/impg/c854420/v854420865/1a5460/tLEFgV96Yiw.jpg?size=557x67&quality=96&sign=462fd032d2b71c99bdee566de27f8297&type=album">https://sun9-46.userapi.com/impg/c854420/v854420865/1a5460/tLEFgV96Yiw.jpg?size=557x67&quality=96&sign=462fd032d2b71c99bdee566de27f8297&type=album</a></p>
<p>В итоге формула для критерия хи-квадрат следующая:</p>
<p><a href="https://sun9-1.userapi.com/impg/c855236/v855236925/1ab192/QqmSQutjX_s.jpg?size=483x91&quality=96&sign=873d6948483484da165287a25a38a809&type=album">https://sun9-1.userapi.com/impg/c855236/v855236925/1ab192/QqmSQutjX_s.jpg?size=483x91&quality=96&sign=873d6948483484da165287a25a38a809&type=album</a></p>
<p>На всякий: n(…) это количество обьектов определенного класса(или классов) из нашей выборки, tf — теоретическая частота</p>
<p>Затем это значение подставляется в исходную формулу, где остальные переменные известны.</p>
<p>Приведем пример(из манги да): провели опрос среди читателей журнала с просьбой указать желаемый вид признания в любви из трех и свой пол. Получили следующие данные:</p>
<p><a href="https://sun9-87.userapi.com/impg/c854420/v854420865/1a547b/YJUFPC0mLGY.jpg?size=807x231&quality=96&sign=464d1ee30584bd2a86ae206a0cc0a196&type=album">https://sun9-87.userapi.com/impg/c854420/v854420865/1a547b/YJUFPC0mLGY.jpg?size=807x231&quality=96&sign=464d1ee30584bd2a86ae206a0cc0a196&type=album</a></p>
<p>Выражения для теоретических частот для каждой пары классов. В каждом столбце внизу написано количество обьектов по способу признания, а справа для каждой строки количество обьектов для каждого пола.
Формула для теоретической частоты в нашем случае: n(способ) * n(пол) / N, для каждой пары (способ, пол):</p>
<p><a href="https://sun9-81.userapi.com/impg/c854420/v854420865/1a5484/lx1ADZfccP8.jpg?size=807x312&quality=96&sign=0fc2572e7e8cb20bb98fc86b83f06b2f&type=album">https://sun9-81.userapi.com/impg/c854420/v854420865/1a5484/lx1ADZfccP8.jpg?size=807x312&quality=96&sign=0fc2572e7e8cb20bb98fc86b83f06b2f&type=album</a></p>
<p>Находим коэффициент хи-квадрат:</p>
<p><a href="https://sun9-65.userapi.com/impg/c854420/v854420865/1a548d/ZlCHKeq-k6A.jpg?size=807x410&quality=96&sign=07eb2db149ee0761f3335798d691aec8&type=album">https://sun9-65.userapi.com/impg/c854420/v854420865/1a548d/ZlCHKeq-k6A.jpg?size=807x410&quality=96&sign=07eb2db149ee0761f3335798d691aec8&type=album</a></p>
<p>Подставим это значение в формулу для коэффициента Крамера:</p>
<p><a href="https://sun9-73.userapi.com/impg/c854420/v854420865/1a5495/bNX8UHcPQkY.jpg?size=792x125&quality=96&sign=f2a4ae8d97d49eeeadb64cd360495dff&type=album">https://sun9-73.userapi.com/impg/c854420/v854420865/1a5495/bNX8UHcPQkY.jpg?size=792x125&quality=96&sign=f2a4ae8d97d49eeeadb64cd360495dff&type=album</a></p>
<p>Получили значение, которое говорит об отстутствии связи. Другими словами не получится хорошо предсказывать желаемый способ признания для человека, зная только его пол. И наоборот, зная, какой способ признания нравится человеку(с которым вы например переписываетесь в интернете) определить его пол.</p>
<p>Таблица, для интерпретации тесноты связи та же, что и для отношения корреляции. Здесь коэффициент меньше 0,25 так что связь слабая.
Вывод</p>
<p>Таким образом, если у вас есть категориальные значения, и вы хотите посчитать их связь с целевой переменной или классом, то не все так плохо! Соответствующие коэффициенты считаются за линейное время и позволяют также, как и корреляция Пирсона, говорить о связи переменных.</p>
<p>Мне же теперь придется использовать эти коэффициенты для оценок полезности в соревновании про дома и, возможно, других исследованиях.</p>
</div>
<footer class=post-footer>
<ul class=post-tags>
<li><a href=https://rprtr258.github.io/tags/middleread/>middleread</a></li>
</ul>
<nav class=paginav>
<a class=prev href=https://rprtr258.github.io/posts/2019-12-21-12-21-00/>
<span class=title>« Prev</span>
<br>
<span>Abobus</span>
</a>
<a class=next href=https://rprtr258.github.io/posts/2019-12-20-18-57-53/>
<span class=title>Next »</span>
<br>
<span>Abobus</span>
</a>
</nav>
</footer>
</article>
</main>
<a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a>
<script>let menu=document.getElementById('menu');menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script>
<script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script>
<script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script>
</body>
</html>